Index: app/src/main/java/com/glitchstacks/musiczone/Common/VerifyOTP.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.glitchstacks.musiczone.Common;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.arch.core.executor.TaskExecutor;\r\n\r\nimport android.app.Activity;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.Gravity;\r\nimport android.view.View;\r\nimport android.view.WindowManager;\r\nimport android.widget.Toast;\r\n\r\nimport com.chaos.view.PinView;\r\nimport com.glitchstacks.musiczone.R;\r\nimport com.glitchstacks.musiczone.TicketDashboard;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.gms.tasks.TaskExecutors;\r\nimport com.google.firebase.FirebaseException;\r\nimport com.google.firebase.auth.AuthResult;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseAuthInvalidCredentialsException;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.PhoneAuthCredential;\r\nimport com.google.firebase.auth.PhoneAuthOptions;\r\nimport com.google.firebase.auth.PhoneAuthProvider;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\n\r\nimport java.util.concurrent.TimeUnit;\r\n\r\npublic class VerifyOTP extends AppCompatActivity {\r\n\r\n    private FirebaseAuth mAuth;\r\n    String codeBySystem;\r\n    PinView pinFromUser;\r\n\r\n    private PhoneAuthProvider.OnVerificationStateChangedCallbacks mCallbacks =\r\n            new PhoneAuthProvider.OnVerificationStateChangedCallbacks() {\r\n\r\n                @Override\r\n                public void onCodeSent(@NonNull String s, @NonNull PhoneAuthProvider.ForceResendingToken forceResendingToken) {\r\n                    codeBySystem = s;\r\n                }\r\n\r\n                @Override\r\n                public void onVerificationCompleted(@NonNull PhoneAuthCredential phoneAuthCredential) {\r\n                    String code = phoneAuthCredential.getSmsCode();\r\n                    if (code != null) {\r\n                        pinFromUser.setText(code);\r\n                        verifyCode(code);\r\n                    }\r\n                }\r\n\r\n                @Override\r\n                public void onVerificationFailed(@NonNull FirebaseException e) {\r\n                    Toast.makeText(VerifyOTP.this, e.getMessage(), Toast.LENGTH_SHORT).show();\r\n                }\r\n            };\r\n\r\n    private void verifyCode(String code) {\r\n\r\n        try {\r\n            PhoneAuthCredential credential = PhoneAuthProvider.getCredential(codeBySystem, code);\r\n            signInWithPhoneAuthCredential(credential);\r\n        } catch (Exception e) {\r\n            Toast toast = Toast.makeText(this, \"Verification Code is wrong\", Toast.LENGTH_SHORT);\r\n            toast.setGravity(Gravity.CENTER, 0, 0);\r\n            toast.show();\r\n        }\r\n\r\n    }\r\n\r\n    private void signInWithPhoneAuthCredential(PhoneAuthCredential credential) {\r\n\r\n        try{\r\n            mAuth.signInWithCredential(credential)\r\n                    .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                        @Override\r\n                        public void onComplete(@NonNull Task<AuthResult> task) {\r\n                            if (task.isSuccessful()) {\r\n\r\n                                Toast.makeText(VerifyOTP.this, \"Verification Completed!\", Toast.LENGTH_SHORT).show();\r\n\r\n                                try{\r\n                                    createNewUser();\r\n                                }catch (Exception i){\r\n                                    Toast.makeText(VerifyOTP.this, i.getMessage(), Toast.LENGTH_SHORT).show();\r\n                                }\r\n\r\n                            } else {\r\n\r\n                                if (task.getException() instanceof FirebaseAuthInvalidCredentialsException) {\r\n                                    Toast.makeText(VerifyOTP.this, \"Verification Failed! Try Again!\", Toast.LENGTH_SHORT).show();\r\n                                }\r\n                            }\r\n                        }\r\n\r\n\r\n                    });\r\n        }catch(Exception e){\r\n            Toast toast = Toast.makeText(this, e.getMessage().toString(), Toast.LENGTH_SHORT);\r\n            toast.setGravity(Gravity.CENTER, 0, 0);\r\n            toast.show();\r\n        }\r\n    }\r\n\r\n    private void createNewUser() {\r\n\r\n        String fullname = getIntent().getStringExtra(\"fullname\");\r\n        String email = getIntent().getStringExtra(\"email\");\r\n        String username = getIntent().getStringExtra(\"username\");\r\n        String password = getIntent().getStringExtra(\"password\");\r\n        String date = getIntent().getStringExtra(\"date\");\r\n        String gender = getIntent().getStringExtra(\"gender\");\r\n        String phoneNo = getIntent().getStringExtra(\"phoneNo\");\r\n\r\n        Toast.makeText(VerifyOTP.this, username+password+date+gender+phoneNo+fullname, Toast.LENGTH_SHORT).show();\r\n\r\n        FirebaseDatabase rootNode = FirebaseDatabase.getInstance();\r\n        DatabaseReference reference = rootNode.getReference(\"Users\");\r\n\r\n        reference.setValue(\"FirstRecord!\");\r\n\r\n        UserHelperClass addNewUser = new UserHelperClass(fullname, username, email, phoneNo, password, date, gender);\r\n\r\n        reference.child(phoneNo).setValue(addNewUser);\r\n\r\n//        startActivity(new Intent(getApplicationContext(), TicketDashboard.class));\r\n//        finish();\r\n\r\n\r\n    }\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);\r\n        setContentView(R.layout.activity_verify_o_t_p);\r\n\r\n        mAuth = FirebaseAuth.getInstance();\r\n        //hooks\r\n        pinFromUser = findViewById(R.id.pin_view);\r\n\r\n        String fullname = getIntent().getStringExtra(\"fullname\");\r\n        String email = getIntent().getStringExtra(\"email\");\r\n        String username = getIntent().getStringExtra(\"username\");\r\n        String password = getIntent().getStringExtra(\"password\");\r\n        String date = getIntent().getStringExtra(\"date\");\r\n        String gender = getIntent().getStringExtra(\"gender\");\r\n        String phoneNo = getIntent().getStringExtra(\"phoneNo\");\r\n\r\n        sendVerificationCodeToUser(phoneNo.toString());\r\n\r\n    }\r\n\r\n    private void sendVerificationCodeToUser(String phoneNo) {\r\n\r\n        PhoneAuthOptions options =\r\n                PhoneAuthOptions.newBuilder(mAuth)\r\n                        .setPhoneNumber(phoneNo)       // Phone number to verify\r\n                        .setTimeout(10L, TimeUnit.SECONDS) // Timeout and unit\r\n                        .setActivity(VerifyOTP.this)                 // Activity (for callback binding)\r\n                        .setCallbacks(mCallbacks)          // OnVerificationStateChangedCallbacks\r\n                        .build();\r\n        PhoneAuthProvider.verifyPhoneNumber(options);\r\n\r\n    }\r\n\r\n    public void callNextScreenFromOTP(View view) {\r\n\r\n        String code = pinFromUser.getText().toString();\r\n\r\n        verifyCode(code);\r\n\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/com/glitchstacks/musiczone/Common/VerifyOTP.java	(revision a7af7367286f7d20b58c6906545478aaa09ddbc2)
+++ app/src/main/java/com/glitchstacks/musiczone/Common/VerifyOTP.java	(date 1607309966300)
@@ -123,8 +123,6 @@
         FirebaseDatabase rootNode = FirebaseDatabase.getInstance();
         DatabaseReference reference = rootNode.getReference("Users");
 
-        reference.setValue("FirstRecord!");
-
         UserHelperClass addNewUser = new UserHelperClass(fullname, username, email, phoneNo, password, date, gender);
 
         reference.child(phoneNo).setValue(addNewUser);
